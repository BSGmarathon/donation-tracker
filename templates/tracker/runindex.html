{% extends "tracker/index.html" %}
{% load donation_tags %}
{% load i18n %}
{% load url from future %}

{% block title %}{% trans "Run Index" %} -- {{ event.name|title }}{% endblock %}

{% block content %}
	<div class="title">
		<b>
			{% trans "Event" %}:
		</b>
		{{ event.name|title }}
		<b>
			{% trans "Run Index" %}
		</b>
	</div>
<!-- This is awful, and need to be properly styled, but its a start at least -->
    <br />
    <div>
      <form method="get">
        {{ searchForm.as_p }}
        <input type="submit" value="Search" />
      </form>
    </div>
	<table>
		<tr>
			<th>
				{% trans "Name" %}
			</th>
			<th>
				{% trans "Players" %}
			</th>
			<th>
				{% trans "Description" %}
			</th>
			<th>
				{% trans "Start Time" %}
			</th>
			<th>
				{% trans "End Time" %}
			</th>
			<th>
				{% trans "Bid Wars" %}
			</th>
			<th>
				{% trans "Donation Challenges" %}
			</th>
		</tr>
	{% for run in runs %}
		<tr>
			<td>
				<a href="{% url 'tracker.views.run' id=run.id %}">{{ run.name|title }}</a>
			</td>
			<td>
        <!-- This should link to a special 'runner info' index page, rather than the general donor view page -->
				{% for runner in run.runners.all %}
          <a href="{% url 'tracker.views.donor' id=runner.id event=run.event.id %}">{% name runner %}</a>&nbsp;
        {% endfor %}
			</td>
			<td>
				{{ run.description|forumfilter }}
			</td>
			<td>
				{{ run.starttime }}
			</td>
			<td>
				{{ run.endtime }}
			</td>
			{% autoescape off %}
			<td>
				{% if run.choices %}<b>{% trans "Yes" %}</b>{% else %}{% trans "No" %}{% endif %}
			</td>
			<td>
				{% if run.challenges %}<b>{% trans "Yes" %}</b>{% else %}{% trans "No" %}{% endif %}
			</td>
			{% endautoescape %}
		</tr>
	{% endfor %}
	</table>
	{% include "tracker/navfooter.html" %}
{% endblock %}
